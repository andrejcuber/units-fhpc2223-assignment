#!/bin/bash
#SBATCH -n 64 -N 1
#SBATCH -p EPYC
#SBATCH --time=1:30:00

#module load architecture/AMD
module load mkl
module load openBLAS/0.3.23-omp

export LD_LIBRARY_PATH=/u/dssc/acuber00/final_project/ex2/blis/lib:$LD_LIBRARY_PATH

echo "Part 2: increasing proc num"
echo "mkl float"
echo "threads=1"
srun -n1 --cpus-per-task=1 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=2"
srun -n1 --cpus-per-task=2 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=3"
srun -n1 --cpus-per-task=3 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=4"
srun -n1 --cpus-per-task=4 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=6"
srun -n1 --cpus-per-task=6 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=8"
srun -n1 --cpus-per-task=8 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=10"
srun -n1 --cpus-per-task=10 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=12"
srun -n1 --cpus-per-task=12 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=16"
srun -n1 --cpus-per-task=16 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=20"
srun -n1 --cpus-per-task=20 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=24"
srun -n1 --cpus-per-task=24 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=28"
srun -n1 --cpus-per-task=28 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=32"
srun -n1 --cpus-per-task=32 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=36"
srun -n1 --cpus-per-task=36 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=40"
srun -n1 --cpus-per-task=40 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=44"
srun -n1 --cpus-per-task=44 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=48"
srun -n1 --cpus-per-task=48 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=52"
srun -n1 --cpus-per-task=52 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=58"
srun -n1 --cpus-per-task=58 ./gemm_mkl_float.x 16000 10000 16000
echo "threads=64"
srun -n1 --cpus-per-task=64 ./gemm_mkl_float.x 16000 10000 16000

echo "oblas float"
echo "threads=1"
srun -n1 --cpus-per-task=1 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=2"
srun -n1 --cpus-per-task=2 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=3"
srun -n1 --cpus-per-task=3 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=4"
srun -n1 --cpus-per-task=4 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=6"
srun -n1 --cpus-per-task=6 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=8"
srun -n1 --cpus-per-task=8 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=10"
srun -n1 --cpus-per-task=10 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=12"
srun -n1 --cpus-per-task=12 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=16"
srun -n1 --cpus-per-task=16 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=20"
srun -n1 --cpus-per-task=20 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=24"
srun -n1 --cpus-per-task=24 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=28"
srun -n1 --cpus-per-task=28 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=32"
srun -n1 --cpus-per-task=32 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=36"
srun -n1 --cpus-per-task=36 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=40"
srun -n1 --cpus-per-task=40 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=44"
srun -n1 --cpus-per-task=44 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=48"
srun -n1 --cpus-per-task=48 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=52"
srun -n1 --cpus-per-task=52 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=58"
srun -n1 --cpus-per-task=58 ./gemm_oblas_float.x 16000 10000 16000
echo "threads=64"
srun -n1 --cpus-per-task=64 ./gemm_oblas_float.x 16000 10000 16000

echo "blis float"
echo "threads=1"
srun -n1 --cpus-per-task=1 ./gemm_blis_float.x 16000 10000 16000
echo "threads=2"
srun -n1 --cpus-per-task=2 ./gemm_blis_float.x 16000 10000 16000
echo "threads=3"
srun -n1 --cpus-per-task=3 ./gemm_blis_float.x 16000 10000 16000
echo "threads=4"
srun -n1 --cpus-per-task=4 ./gemm_blis_float.x 16000 10000 16000
echo "threads=6"
srun -n1 --cpus-per-task=6 ./gemm_blis_float.x 16000 10000 16000
echo "threads=8"
srun -n1 --cpus-per-task=8 ./gemm_blis_float.x 16000 10000 16000
echo "threads=10"
srun -n1 --cpus-per-task=10 ./gemm_blis_float.x 16000 10000 16000
echo "threads=12"
srun -n1 --cpus-per-task=12 ./gemm_blis_float.x 16000 10000 16000
echo "threads=16"
srun -n1 --cpus-per-task=16 ./gemm_blis_float.x 16000 10000 16000
echo "threads=20"
srun -n1 --cpus-per-task=20 ./gemm_blis_float.x 16000 10000 16000
echo "threads=24"
srun -n1 --cpus-per-task=24 ./gemm_blis_float.x 16000 10000 16000
echo "threads=28"
srun -n1 --cpus-per-task=28 ./gemm_blis_float.x 16000 10000 16000
echo "threads=32"
srun -n1 --cpus-per-task=32 ./gemm_blis_float.x 16000 10000 16000
echo "threads=36"
srun -n1 --cpus-per-task=36 ./gemm_blis_float.x 16000 10000 16000
echo "threads=40"
srun -n1 --cpus-per-task=40 ./gemm_blis_float.x 16000 10000 16000
echo "threads=44"
srun -n1 --cpus-per-task=44 ./gemm_blis_float.x 16000 10000 16000
echo "threads=48"
srun -n1 --cpus-per-task=48 ./gemm_blis_float.x 16000 10000 16000
echo "threads=52"
srun -n1 --cpus-per-task=52 ./gemm_blis_float.x 16000 10000 16000
echo "threads=58"
srun -n1 --cpus-per-task=58 ./gemm_blis_float.x 16000 10000 16000
echo "threads=64"
srun -n1 --cpus-per-task=64 ./gemm_blis_float.x 16000 10000 16000

echo "mkl double"
echo "threads=1"
srun -n1 --cpus-per-task=1 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=2"
srun -n1 --cpus-per-task=2 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=3"
srun -n1 --cpus-per-task=3 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=4"
srun -n1 --cpus-per-task=4 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=6"
srun -n1 --cpus-per-task=6 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=8"
srun -n1 --cpus-per-task=8 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=10"
srun -n1 --cpus-per-task=10 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=12"
srun -n1 --cpus-per-task=12 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=16"
srun -n1 --cpus-per-task=16 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=20"
srun -n1 --cpus-per-task=20 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=24"
srun -n1 --cpus-per-task=24 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=28"
srun -n1 --cpus-per-task=28 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=32"
srun -n1 --cpus-per-task=32 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=36"
srun -n1 --cpus-per-task=36 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=40"
srun -n1 --cpus-per-task=40 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=44"
srun -n1 --cpus-per-task=44 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=48"
srun -n1 --cpus-per-task=48 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=52"
srun -n1 --cpus-per-task=52 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=58"
srun -n1 --cpus-per-task=58 ./gemm_mkl_double.x 16000 10000 16000
echo "threads=64"
srun -n1 --cpus-per-task=64 ./gemm_mkl_double.x 16000 10000 16000

echo "oblas double"
echo "threads=1"
srun -n1 --cpus-per-task=1 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=2"
srun -n1 --cpus-per-task=2 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=3"
srun -n1 --cpus-per-task=3 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=4"
srun -n1 --cpus-per-task=4 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=6"
srun -n1 --cpus-per-task=6 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=8"
srun -n1 --cpus-per-task=8 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=10"
srun -n1 --cpus-per-task=10 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=12"
srun -n1 --cpus-per-task=12 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=16"
srun -n1 --cpus-per-task=16 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=20"
srun -n1 --cpus-per-task=20 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=24"
srun -n1 --cpus-per-task=24 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=28"
srun -n1 --cpus-per-task=28 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=32"
srun -n1 --cpus-per-task=32 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=36"
srun -n1 --cpus-per-task=36 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=40"
srun -n1 --cpus-per-task=40 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=44"
srun -n1 --cpus-per-task=44 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=48"
srun -n1 --cpus-per-task=48 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=52"
srun -n1 --cpus-per-task=52 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=58"
srun -n1 --cpus-per-task=58 ./gemm_oblas_double.x 16000 10000 16000
echo "threads=64"
srun -n1 --cpus-per-task=64 ./gemm_oblas_double.x 16000 10000 16000

echo "blis double"
echo "threads=1"
srun -n1 --cpus-per-task=1 ./gemm_blis_double.x 16000 10000 16000
echo "threads=2"
srun -n1 --cpus-per-task=2 ./gemm_blis_double.x 16000 10000 16000
echo "threads=3"
srun -n1 --cpus-per-task=3 ./gemm_blis_double.x 16000 10000 16000
echo "threads=4"
srun -n1 --cpus-per-task=4 ./gemm_blis_double.x 16000 10000 16000
echo "threads=6"
srun -n1 --cpus-per-task=6 ./gemm_blis_double.x 16000 10000 16000
echo "threads=8"
srun -n1 --cpus-per-task=8 ./gemm_blis_double.x 16000 10000 16000
echo "threads=10"
srun -n1 --cpus-per-task=10 ./gemm_blis_double.x 16000 10000 16000
echo "threads=12"
srun -n1 --cpus-per-task=12 ./gemm_blis_double.x 16000 10000 16000
echo "threads=16"
srun -n1 --cpus-per-task=16 ./gemm_blis_double.x 16000 10000 16000
echo "threads=20"
srun -n1 --cpus-per-task=20 ./gemm_blis_double.x 16000 10000 16000
echo "threads=24"
srun -n1 --cpus-per-task=24 ./gemm_blis_double.x 16000 10000 16000
echo "threads=28"
srun -n1 --cpus-per-task=28 ./gemm_blis_double.x 16000 10000 16000
echo "threads=32"
srun -n1 --cpus-per-task=32 ./gemm_blis_double.x 16000 10000 16000
echo "threads=36"
srun -n1 --cpus-per-task=36 ./gemm_blis_double.x 16000 10000 16000
echo "threads=40"
srun -n1 --cpus-per-task=40 ./gemm_blis_double.x 16000 10000 16000
echo "threads=44"
srun -n1 --cpus-per-task=44 ./gemm_blis_double.x 16000 10000 16000
echo "threads=48"
srun -n1 --cpus-per-task=48 ./gemm_blis_double.x 16000 10000 16000
echo "threads=52"
srun -n1 --cpus-per-task=52 ./gemm_blis_double.x 16000 10000 16000
echo "threads=58"
srun -n1 --cpus-per-task=58 ./gemm_blis_double.x 16000 10000 16000
echo "threads=64"
srun -n1 --cpus-per-task=64 ./gemm_blis_double.x 16000 10000 16000
exit
